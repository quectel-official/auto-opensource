diff -urN a/random/random-drbg.c b/random/random-drbg.c
--- a/random/random-drbg.c	2019-01-09 10:23:27.864000000 +0800
+++ b/random/random-drbg.c	2019-01-09 10:20:31.372000000 +0800
@@ -1000,7 +1000,7 @@
     {
       /* 10.1.2.3 step 2 already implicitly covered with
        * the initial memset(0) of drbg->C */
-      memset (drbg->V, 1, drbg_statelen (drbg));
+      if (drbg_statelen (drbg) > 0) memset (drbg->V, 1, drbg_statelen (drbg));
       ret = drbg_hmac_setkey (drbg, drbg->C);
       if (ret)
 	return ret;
